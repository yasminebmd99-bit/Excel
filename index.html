<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Manager - Gestion et R√©organisation de Fichiers</title>
    <meta name="description"
        content="Application web pour importer, fusionner et r√©organiser vos fichiers Excel facilement">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Outfit:wght@700;800&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- SheetJS Library for Excel Processing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>üìä Excel Manager</h1>
            <p>Importez, fusionnez et r√©organisez vos fichiers Excel en toute simplicit√©</p>
        </header>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="import">üì• Import & Fusion</button>
            <button class="tab-btn" data-tab="reorganize">üîÑ R√©organisation</button>
            <button class="tab-btn" data-tab="export">üíæ Export</button>
        </div>

        <!-- Tab 1: Import & Merge -->
        <div id="import" class="tab-content active">
            <div class="card">
                <h3><span class="card-icon">üìÅ</span> Importer des fichiers Excel</h3>
                <p>S√©lectionnez plusieurs fichiers Excel (.xlsx, .xls, .csv) √† fusionner</p>

                <div class="upload-zone" id="uploadZone">
                    <div class="upload-icon">‚òÅÔ∏è</div>
                    <h3>Glissez vos fichiers ici</h3>
                    <p>ou cliquez pour s√©lectionner</p>
                    <input type="file" id="fileInput" multiple accept=".xlsx,.xls,.csv">
                </div>

                <div id="fileListContainer" class="file-list hidden">
                    <h4>Fichiers import√©s :</h4>
                    <div id="fileList"></div>
                </div>
            </div>

            <div class="card hidden" id="mergeCard">
                <h3><span class="card-icon">üîó</span> Fusionner les fichiers</h3>
                <p>Combinez tous les fichiers import√©s en un seul fichier consolid√©</p>

                <button class="btn btn-primary" id="mergeBtn">
                    <span>üîó</span> Fusionner les fichiers
                </button>

                <div id="mergePreview" class="hidden mt-lg">
                    <h4>Aper√ßu du fichier fusionn√© :</h4>
                    <div class="table-container" id="mergeTableContainer"></div>
                    <p class="mt-lg"><strong id="mergeStats"></strong></p>
                </div>
            </div>
        </div>

        <!-- Tab 2: Reorganize -->
        <div id="reorganize" class="tab-content">
            <div class="card" id="reorganizeImportCard">
                <h3><span class="card-icon">üìã</span> Importer un fichier √† r√©organiser</h3>
                <p>Importez un fichier Excel avec des colonnes mal structur√©es</p>

                <div class="upload-zone" id="reorganizeUploadZone">
                    <div class="upload-icon">‚òÅÔ∏è</div>
                    <h3>Glissez votre fichier ici</h3>
                    <p>ou cliquez pour s√©lectionner</p>
                    <input type="file" id="reorganizeFileInput" accept=".xlsx,.xls,.csv">
                </div>
            </div>

            <div class="card hidden" id="mappingCard">
                <h3><span class="card-icon">üéØ</span> R√©organiser les colonnes</h3>
                <p>Cliquez sur "D√©tection automatique" pour mapper automatiquement les colonnes</p>

                <!-- Actions et options sur une ligne -->
                <div
                    style="display: flex; flex-wrap: wrap; gap: var(--spacing-md); align-items: center; margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: var(--bg-tertiary); border-radius: var(--radius-md); border: 1px solid var(--border);">
                    <button class="btn btn-secondary" id="autoMapBtn">
                        <span>‚ú®</span> D√©tection automatique
                    </button>

                    <label
                        style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer; padding: 0.5rem 1rem; background: var(--surface); border-radius: var(--radius-md); border: 1px solid var(--border);">
                        <input type="checkbox" id="removeLeadingZero" style="width: auto; cursor: pointer;">
                        <span style="color: var(--text-primary); font-weight: 600;">üìû Supprimer le 0</span>
                    </label>

                    <label
                        style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer; padding: 0.5rem 1rem; background: var(--surface); border-radius: var(--radius-md); border: 1px solid var(--border);">
                        <input type="checkbox" id="removePlus33" style="width: auto; cursor: pointer;">
                        <span style="color: var(--text-primary); font-weight: 600;">üìû Supprimer +33</span>
                    </label>
                </div>

                <div class="mapping-container">
                    <div class="column-list">
                        <h4>Colonnes actuelles</h4>
                        <div id="currentColumns"></div>
                    </div>

                    <div class="mapping-arrow">‚Üí</div>

                    <div class="column-list">
                        <h4>Titres attendus</h4>
                        <div id="targetColumns"></div>
                    </div>
                </div>

                <button class="btn btn-success mt-lg" id="applyMappingBtn">
                    <span>‚úì</span> Appliquer la r√©organisation
                </button>

                <div id="reorganizePreview" class="hidden mt-lg">
                    <h4>Aper√ßu du fichier r√©organis√© :</h4>
                    <div class="table-container" id="reorganizeTableContainer"></div>
                </div>
            </div>
        </div>

        <!-- Tab 3: Export -->
        <div id="export" class="tab-content">
            <div class="card">
                <h3><span class="card-icon">üíæ</span> Exporter votre fichier</h3>
                <p id="exportMessage">Aucun fichier pr√™t √† exporter. Veuillez d'abord fusionner ou r√©organiser des
                    fichiers.</p>

                <div id="exportOptions" class="hidden">
                    <h4>Choisissez le format d'export :</h4>
                    <div class="format-selector">
                        <label class="format-option selected">
                            <input type="radio" name="exportFormat" value="xlsx" checked>
                            <div class="format-icon">üìó</div>
                            <div class="format-label">XLSX</div>
                            <div class="format-desc">Excel moderne</div>
                        </label>

                        <label class="format-option">
                            <input type="radio" name="exportFormat" value="xls">
                            <div class="format-icon">üìò</div>
                            <div class="format-label">XLS</div>
                            <div class="format-desc">Excel legacy</div>
                        </label>

                        <label class="format-option">
                            <input type="radio" name="exportFormat" value="csv">
                            <div class="format-icon">üìÑ</div>
                            <div class="format-label">CSV</div>
                            <div class="format-desc">Valeurs s√©par√©es</div>
                        </label>

                        <label class="format-option">
                            <input type="radio" name="exportFormat" value="ods">
                            <div class="format-icon">üìô</div>
                            <div class="format-label">ODS</div>
                            <div class="format-desc">OpenDocument</div>
                        </label>
                    </div>

                    <div class="mt-lg">
                        <label for="exportFileName">
                            <h4>Nom du fichier :</h4>
                        </label>
                        <input type="text" id="exportFileName" value="fichier_exporte" placeholder="Nom du fichier">
                    </div>

                    <button class="btn btn-primary mt-lg" id="exportBtn">
                        <span>‚¨áÔ∏è</span> T√©l√©charger le fichier
                    </button>

                    <div id="exportPreview" class="mt-lg">
                        <h4>Aper√ßu :</h4>
                        <div class="table-container" id="exportTableContainer"></div>
                        <p class="mt-lg"><strong id="exportStats"></strong></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alert Container -->
        <div id="alertContainer"></div>
    </div>

    <!-- JavaScript -->
    <script src="app.js"></script>
</body>

</html>