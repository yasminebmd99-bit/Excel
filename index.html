<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Manager - Gestion et R√©organisation de Fichiers Excel</title>
    <meta name="description"
        content="Application web pour importer, fusionner et r√©organiser vos fichiers Excel facilement. Traitement 100% local dans votre navigateur.">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@700;800&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- SheetJS Library for Excel Processing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>

<body>
    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>üìä Excel Manager</h1>
            <p class="hero-subtitle">Importez, fusionnez et r√©organisez vos fichiers Excel facilement</p>
            <p class="hero-description">Un outil simple et gratuit pour g√©rer vos donn√©es Excel. Tout est trait√©
                localement dans votre navigateur.</p>
        </div>
    </section>

    <!-- Privacy Notice -->
    <div class="privacy-notice">
        <div class="container">
            <span>üîí</span>
            <span><strong>100% Confidentiel</strong> - Vos donn√©es ne quittent jamais votre navigateur. Aucun fichier
                n'est envoy√© sur un serveur.</span>
        </div>
    </div>

    <!-- Main App -->
    <main class="container">
        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Import</div>
            </div>
            <div class="step-line"></div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Organisation</div>
            </div>
            <div class="step-line"></div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Export</div>
            </div>
        </div>

        <!-- Tab Navigation Cards -->
        <div class="tab-cards">
            <div class="tab-card active" data-tab="import">
                <div class="tab-card-icon">üì•</div>
                <div class="tab-card-title">Import & Fusion</div>
                <div class="tab-card-desc">Importer et fusionner vos fichiers</div>
            </div>
            <div class="tab-card" data-tab="reorganize">
                <div class="tab-card-icon">üîÑ</div>
                <div class="tab-card-title">R√©organisation</div>
                <div class="tab-card-desc">Organiser l'ordre des colonnes</div>
            </div>
            <div class="tab-card" data-tab="export">
                <div class="tab-card-icon">üíæ</div>
                <div class="tab-card-title">Export</div>
                <div class="tab-card-desc">T√©l√©charger le fichier final</div>
            </div>
        </div>

        <!-- Tab 1: Import & Merge -->
        <div id="import" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h3><span class="card-icon">üìÅ</span> Importer des fichiers Excel</h3>
                    <p>D√©posez vos fichiers Excel ici pour les fusionner en un seul fichier</p>
                </div>

                <div class="upload-zone" id="uploadZone">
                    <div class="upload-icon">‚òÅÔ∏è</div>
                    <h3>D√©posez vos fichiers Excel ici</h3>
                    <p>ou cliquez pour les s√©lectionner</p>
                    <div class="upload-formats">
                        <span class="format-badge">XLSX</span>
                        <span class="format-badge">XLS</span>
                        <span class="format-badge">CSV</span>
                    </div>
                    <p class="upload-hint">Taille recommand√©e : moins de 10 Mo par fichier</p>
                    <input type="file" id="fileInput" multiple accept=".xlsx,.xls,.csv">
                </div>

                <div class="example-download">
                    <button class="btn btn-outline" id="downloadExampleBtn">
                        <span>üìÑ</span> T√©l√©charger un fichier Excel d'exemple
                    </button>
                </div>

                <div id="fileListContainer" class="file-list hidden">
                    <div class="file-list-header">
                        <h4>Fichiers import√©s</h4>
                        <span class="file-count" id="fileCount">0 fichiers</span>
                    </div>
                    <div id="fileList"></div>
                    <div id="importStats" class="import-stats hidden"></div>
                </div>
            </div>

            <div class="card hidden" id="mergeCard">
                <div class="card-header">
                    <h3><span class="card-icon">üîó</span> Fusionner les fichiers</h3>
                    <p>Combinez tous les fichiers import√©s en un seul fichier consolid√©</p>
                </div>

                <button class="btn btn-primary btn-lg" id="mergeBtn">
                    <span>üîó</span> Fusionner les fichiers
                </button>

                <div id="mergePreview" class="hidden mt-lg">
                    <div class="preview-header">
                        <h4>Aper√ßu du fichier fusionn√©</h4>
                        <div class="preview-stats" id="mergeStats"></div>
                    </div>
                    <div class="table-container" id="mergeTableContainer"></div>

                    <div class="action-buttons">
                        <button class="btn btn-success btn-lg" id="proceedToReorgBtn">
                            <span>‚û°Ô∏è</span> Passer √† l'organisation des colonnes
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2: Reorganize -->
        <div id="reorganize" class="tab-content">
            <div class="card" id="reorganizeImportCard">
                <div class="card-header">
                    <h3><span class="card-icon">üìã</span> Importer un fichier √† r√©organiser</h3>
                    <p>Importez un fichier Excel pour r√©organiser ses colonnes</p>
                </div>

                <div class="upload-zone" id="reorganizeUploadZone">
                    <div class="upload-icon">‚òÅÔ∏è</div>
                    <h3>D√©posez votre fichier ici</h3>
                    <p>ou cliquez pour le s√©lectionner</p>
                    <input type="file" id="reorganizeFileInput" accept=".xlsx,.xls,.csv">
                </div>
            </div>

            <div class="card hidden" id="mappingCard">
                <div class="card-header">
                    <h3><span class="card-icon">üéØ</span> Organiser les colonnes</h3>
                    <p>R√©organisez l'ordre des colonnes par glisser-d√©poser et choisissez celles √† afficher</p>
                </div>

                <!-- Actions Bar -->
                <div class="actions-bar">
                    <button class="btn btn-secondary" id="autoMapBtn">
                        <span>‚ú®</span> D√©tection automatique
                    </button>

                    <div class="phone-options">
                        <label class="checkbox-option">
                            <input type="checkbox" id="removeLeadingZero">
                            <span>üìû Supprimer le 0</span>
                        </label>

                        <label class="checkbox-option">
                            <input type="checkbox" id="removePlus33">
                            <span>üìû Supprimer +33</span>
                        </label>
                    </div>
                </div>

                <!-- Column Visibility Controls -->
                <div class="column-controls">
                    <div class="column-controls-header">
                        <h4>Colonnes √† afficher</h4>
                        <div class="column-controls-actions">
                            <button class="btn btn-sm" id="selectAllColumns">‚úì Tout cocher</button>
                            <button class="btn btn-sm" id="deselectAllColumns">‚úó Tout d√©cocher</button>
                        </div>
                    </div>
                    <div id="columnCheckboxes" class="column-checkboxes"></div>
                </div>

                <!-- Drag & Drop Column Organizer -->
                <div class="column-organizer">
                    <h4>Ordre des colonnes <span class="hint">(glissez-d√©posez pour r√©organiser)</span></h4>
                    <div id="sortableColumns" class="sortable-columns"></div>
                </div>

                <!-- Preview -->
                <div id="columnPreview" class="column-preview hidden">
                    <h4>Aper√ßu</h4>
                    <div class="table-container" id="previewTableContainer"></div>
                </div>

                <button class="btn btn-success btn-lg mt-lg" id="applyMappingBtn">
                    <span>‚úì</span> Appliquer la r√©organisation
                </button>

                <div id="reorganizePreview" class="hidden mt-lg">
                    <div class="preview-header">
                        <h4>R√©sultat de la r√©organisation</h4>
                    </div>
                    <div class="table-container" id="reorganizeTableContainer"></div>

                    <div class="action-buttons">
                        <button class="btn btn-success btn-lg" id="proceedToExportBtn">
                            <span>üíæ</span> Passer √† l'export
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 3: Export -->
        <div id="export" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3><span class="card-icon">üíæ</span> Exporter votre fichier</h3>
                    <p id="exportMessage">Pr√©parez votre fichier Excel pour le t√©l√©chargement</p>
                </div>

                <div id="noDataMessage" class="no-data-message">
                    <div class="no-data-icon">üì≠</div>
                    <p>Aucun fichier pr√™t √† exporter.</p>
                    <p>Veuillez d'abord fusionner ou r√©organiser des fichiers.</p>
                </div>

                <div id="exportOptions" class="hidden">
                    <h4>Format de sortie</h4>
                    <div class="format-selector">
                        <label class="format-option selected">
                            <input type="radio" name="exportFormat" value="xlsx" checked>
                            <div class="format-icon">üìó</div>
                            <div class="format-label">XLSX</div>
                            <div class="format-desc">Excel moderne</div>
                        </label>

                        <label class="format-option">
                            <input type="radio" name="exportFormat" value="xls">
                            <div class="format-icon">üìò</div>
                            <div class="format-label">XLS</div>
                            <div class="format-desc">Excel legacy</div>
                        </label>

                        <label class="format-option">
                            <input type="radio" name="exportFormat" value="csv">
                            <div class="format-icon">üìÑ</div>
                            <div class="format-label">CSV</div>
                            <div class="format-desc">Valeurs s√©par√©es</div>
                        </label>

                        <label class="format-option">
                            <input type="radio" name="exportFormat" value="ods">
                            <div class="format-icon">üìô</div>
                            <div class="format-label">ODS</div>
                            <div class="format-desc">OpenDocument</div>
                        </label>
                    </div>

                    <div class="export-filename">
                        <label for="exportFileName">
                            <h4>Nom du fichier</h4>
                        </label>
                        <input type="text" id="exportFileName" value="fichier_exporte" placeholder="Nom du fichier">
                    </div>

                    <button class="btn btn-primary btn-xl" id="exportBtn">
                        <span>‚¨áÔ∏è</span> T√©l√©charger le fichier Excel
                    </button>

                    <div id="exportPreview" class="mt-lg">
                        <div class="preview-header">
                            <h4>Aper√ßu du fichier</h4>
                            <div class="preview-stats" id="exportStats"></div>
                        </div>
                        <div class="table-container" id="exportTableContainer"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Features Section -->
    <section class="features" id="features">
        <div class="container">
            <h2>Ce que permet l'outil</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üîó</div>
                    <h3>Fusionner des fichiers</h3>
                    <p>Combinez plusieurs fichiers Excel en un seul fichier consolid√© avec toutes vos donn√©es.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîÑ</div>
                    <h3>R√©organiser les colonnes</h3>
                    <p>Changez l'ordre des colonnes, masquez celles inutiles et structurez vos donn√©es.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üì±</div>
                    <h3>Formater les num√©ros</h3>
                    <p>Supprimez automatiquement le "0" ou "+33" des num√©ros de t√©l√©phone fran√ßais.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3>100% Confidentiel</h3>
                    <p>Tout est trait√© localement dans votre navigateur. Aucune donn√©e n'est envoy√©e sur un serveur.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How it works Section -->
    <section class="how-it-works" id="how-it-works">
        <div class="container">
            <h2>Comment √ßa marche ?</h2>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number-large">1</div>
                    <h3>Importez vos fichiers</h3>
                    <p>Glissez-d√©posez vos fichiers Excel (XLSX, XLS, CSV) dans la zone d'import.</p>
                </div>
                <div class="step-arrow">‚Üí</div>
                <div class="step-card">
                    <div class="step-number-large">2</div>
                    <h3>Organisez les colonnes</h3>
                    <p>R√©organisez l'ordre des colonnes par glisser-d√©poser et masquez celles inutiles.</p>
                </div>
                <div class="step-arrow">‚Üí</div>
                <div class="step-card">
                    <div class="step-number-large">3</div>
                    <h3>T√©l√©chargez le r√©sultat</h3>
                    <p>Exportez votre fichier Excel nettoy√© et bien structur√©.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq" id="faq">
        <div class="container">
            <h2>Questions fr√©quentes</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h4>Quels formats sont support√©s ?</h4>
                    <p>L'outil supporte les formats XLSX (Excel moderne), XLS (Excel legacy), CSV (valeurs s√©par√©es par
                        des virgules) et ODS (OpenDocument).</p>
                </div>
                <div class="faq-item">
                    <h4>Quelle est la taille maximale des fichiers ?</h4>
                    <p>Nous recommandons des fichiers de moins de 10 Mo pour des performances optimales. Les fichiers
                        plus volumineux peuvent ralentir le traitement.</p>
                </div>
                <div class="faq-item">
                    <h4>Combien de fichiers puis-je fusionner ?</h4>
                    <p>Vous pouvez fusionner autant de fichiers que vous le souhaitez. Cependant, pour des raisons de
                        performance, nous recommandons de ne pas d√©passer 50 000 lignes au total.</p>
                </div>
                <div class="faq-item">
                    <h4>Mes donn√©es sont-elles s√©curis√©es ?</h4>
                    <p>Oui ! Tout le traitement se fait localement dans votre navigateur. Aucune donn√©e n'est envoy√©e
                        sur un serveur. Vos fichiers restent sur votre ordinateur.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>üìä Excel Manager</h3>
                    <p>Un outil simple pour g√©rer vos fichiers Excel.</p>
                </div>
                <div class="footer-links">
                    <h4>Liens utiles</h4>
                    <a href="#features">Fonctionnalit√©s</a>
                    <a href="#how-it-works">Comment √ßa marche</a>
                    <a href="#faq">FAQ</a>
                </div>
                <div class="footer-legal">
                    <h4>L√©gal</h4>
                    <a href="#privacy">Politique de confidentialit√©</a>
                    <a href="#terms">Mentions l√©gales</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 Excel Manager. Tous droits r√©serv√©s.</p>
            </div>
        </div>
    </footer>

    <!-- Loader -->
    <div id="loader" class="loader hidden">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Traitement en cours...</p>
        </div>
    </div>

    <!-- Alert Container -->
    <div id="alertContainer"></div>

    <!-- JavaScript -->
    <script src="app.js"></script>
</body>

</html>